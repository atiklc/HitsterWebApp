{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>Hitster â€“ Admin panel v2</h2>

  <h3>Create & open a new round</h3>
  <form method="post">
    <input type="hidden" name="action" value="create_round">

    <label>Question (e.g. "Song #3")</label>
    <textarea name="question" rows="2" placeholder="Text players see"></textarea>

    <label>Correct song (optional now)</label>
    <input type="text" name="correct_song" placeholder="Exact song title">

    <label>Correct artist (optional now)</label>
    <input type="text" name="correct_artist" placeholder="Exact artist name">

    <label>Correct year (optional now)</label>
    <input type="text" name="correct_year" placeholder="e.g. 1976">

    <button type="submit" class="btn">Create + open round</button>
  </form>
</div>

<div class="card">
  <h3>Current open round</h3>
  {% if current_round %}
    <p><strong>ID:</strong> {{ current_round['id'] }}</p>
    <p><strong>Question:</strong> {{ current_round['question'] }}</p>

    <form method="post" style="margin-top:8px; margin-bottom: 8px;">
      <input type="hidden" name="action" value="set_answers">

      <label>Correct song</label>
      <input type="text" name="correct_song" value="{{ current_round['correct_song'] or '' }}">

      <label>Correct artist</label>
      <input type="text" name="correct_artist" value="{{ current_round['correct_artist'] or '' }}">

      <label>Correct year</label>
      <input type="text" name="correct_year" value="{{ current_round['correct_year'] or '' }}">

      <button type="submit" class="btn">Update correct answers</button>
    </form>

    <form method="post">
      <input type="hidden" name="action" value="close_round">
      <button type="submit" class="btn secondary">Close & score this round</button>
    </form>
  {% else %}
    <p>No open round.</p>
  {% endif %}
</div>

<div class="card">
  <h3>Recent rounds</h3>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Status</th>
        <th>Question</th>
        <th>Song</th>
        <th>Artist</th>
        <th>Year</th>
        <th>Created</th>
      </tr>
    </thead>
    <tbody>
      {% for r in rounds %}
        <tr>
          <td>{{ r['id'] }}</td>
          <td>{{ r['status'] }}</td>
          <td>{{ r['question'] }}</td>
          <td>{{ r['correct_song'] }}</td>
          <td>{{ r['correct_artist'] }}</td>
          <td>{{ r['correct_year'] }}</td>
          <td>{{ r['created_at'] }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
